<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--<meta name="color-scheme" content="dark light">-->
    <title>Builder</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="/graphics/favicon.svg" type="image/x-icon">
    <style>
        #overlay {
            --size: 10em;
            display: flex;
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            padding: 2em;
            flex-wrap: wrap;
            justify-content: center;
            align-content: start;
            gap: 0 calc(var(--size) / 10);
            background-color: var(--color-main-bg);
            z-index: 1000;
        }
        #overlay div {
            width: var(--size);
            height: var(--size);
            border-radius: 100vh;
        }
        #overlay div:nth-child(2n + 1 of .wrapped) {
            /*margin-left: calc(var(--size));*/
        }
    </style>
</head>
<body>
    <div id="overlay"></div>
    <script>
        let overlay = document.getElementById('overlay');
        for (let i = 0; i < 20; i++) {
            let randomRGB = Math.random(255);
            let child = document.createElement('div');
            child.style.backgroundColor = `rgb(${Math.random() * 255}, ${Math.random() * 255}, ${Math.random() * 255})`;
            overlay.appendChild(child);
        }
        function detectWrap(node) {
            console.log('resizing');
            let childBefore = null;
            for (const child of node.children) {
                if (child.offsetTop > node.offsetTop && childBefore && child.offsetTop > childBefore.offsetTop) {
                    child.classList.add("wrapped");
                } else {
                    child.classList.remove("wrapped");
                }
                childBefore = child;
            }
        }
        detectWrap(overlay);
        window.onresize = function() {
            detectWrap(overlay);
        }
    </script>
    <div id="settings"></div>
    <div id="mouse"></div>
    <button class="changeTheme">
        <svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M256 48v48M256 416v48M403.08 108.92l-33.94 33.94M142.86 369.14l-33.94 33.94M464 256h-48M96 256H48M403.08 403.08l-33.94-33.94M142.86 142.86l-33.94-33.94"/><circle cx="256" cy="256" r="80" fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32"/></svg>
        <svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M160 136c0-30.62 4.51-61.61 16-88C99.57 81.27 48 159.32 48 248c0 119.29 96.71 216 216 216 88.68 0 166.73-51.57 200-128-26.39 11.49-57.38 16-88 16-119.29 0-216-96.71-216-216z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/></svg>
    </button>
    <div class="colorPicker">
        <canvas id="colorPicker"></canvas>
        <div class="knob" id="colorKnob"></div>
    </div>
    <!--<span class="float-left"><b>Elements</b></span>-->
    <div id="elementsContainer" class="flex float-left">
        <div id="element1"
             class="element container layout-vertical horizontal-start vertical-start noselect"
             data-name="Container"
             data-min-width="5em"
             data-min-height="5em"
             data-padding="0.5em">
        </div>
        <div id="element2"
             class="element spacing noselect"
             data-name="Spacing">
        </div>
        <div id="element3"
             class="element text noselect"
             data-name="Text">Text
        </div>
        <div id="element5"
             class="element image svg noselect"
             data-name="SVG"
             data-width="5em"
             data-max-height="100%">
            <img src="/graphics/placeholder.svg" alt="Placeholder" width="100%" height="100%">
            <svg xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 512 512">
                <path fill="none" stroke="currentColor" stroke-width="20"
                      d="M96 80C69.49 80 48 101.49 48 128V384C48 410.51 69.49 432 96 432H416C442.51 432 464 410.51 464 384V128C464 101.49 442.51 80 416 80ZM368 176C368 158.33 353.67 144 336 144S304 158.33 304 176 318.33 208 336 208 368 193.67 368 176ZM312 343.79 213.34 245.3A32 32 0 00169.47 244L48 352M224 432 347.34 308.66A32 32 0 01390.45 306.66L464 368" />
            </svg>
        </div>
    </div>
    <div id="structureWrapper">
        <div id="structureContainer"
             class="flex element layout-vertical horizontal-start vertical-start"
             data-name="Container" data-min-height="30em" data-padding="0.5em"
             ondragover="allowDrop(event)" ondrop="drop(event)" ondragleave="dragReset(event)">
            <div class="nothing text-outline">Drag header items and other layouts into here</div>
        </div>
        <div id="previewContainer" class="flex element layout-vertical horizontal-start vertical-start">
            <div class="nothing text-outline">Nothing to see here</div>
        </div>
        <div id="outputContainer" class="flex">
            <div id="html">
                <div class="nothing">Nothing to see here</div>
            </div>
            <div id="css">
                <div class="nothing">Nothing to see here</div>
            </div>
        </div>
    </div>
    <script src="scripts.js"></script>
</body>
</html>